from textblob import TextBlob
import pandas as pd

def analyze_sentiment(df, text_column="post"):
    df["sentiment"] = df[text_column].apply(lambda x: TextBlob(str(x)).sentiment.polarity)
    return df
